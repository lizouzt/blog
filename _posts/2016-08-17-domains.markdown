---
layout:     post
title:      "关于域名解析的那些事情"
subtitle:   "简单的网站域名接入"
date:       2016-08-16 10:00:00
author:     "stefan"
header-img: "img/post-bg-04.jpg"
---

## 各种记录是咋回事儿？

### 一些通用的记录类型说明

* A记录：

    将域名指向一个IPv4地址（例如：10.10.10.10），需要增加A记录

* CNAME记录：

    如果将域名指向一个域名，实现与被指向域名相同的访问效果，需要增加CNAME记录

* MX记录：

    建立电子邮箱服务，将指向邮件服务器地址，需要设置MX记录

* NS记录：

    域名解析服务器记录，如果要将子域名指定某个域名服务器来解析，需要设置NS记录

* TXT记录：
    
    可任意填写（可为空），通常用做SPF记录（反垃圾邮件）使用

* AAAA记录：

    将主机名（或域名）指向一个IPv6地址（例如：ff03:0:0:0:0:0:0:c1），需要添加AAAA记录

* SRV记录：

    记录了哪台计算机提供了哪个服务。格式为：服务的名字.协议的类型（例如：_example-server._tcp）

### 域名服务商提供的其他解析方式

* 显性URL（有的叫显性LINK）：

    将域名指向一个http（s)协议地址，访问域名时，自动跳转至目标地址（例如：将www.net.cn显性转发到www.hichina.com后，访问www.net.cn时，地址栏显示的地址为：www.hichina.com）。

* 隐性URL（有的叫隐性LINK）：

    与显性URL类似，但隐性转发会隐藏真实的目标地址（例如：将www.net.cn隐性转发到www.hichina.com后，访问www.net.cn时，地址栏显示的地址仍然为：www.net.cn）。

## 一般的接入方式

### 情况1：固定IP

www和根域同时配置A记录指向同一个IP。

### 情况2：空间提供商提供二级域名，比如ylw.leanapp.cn

根域名和www同时使用CNAME接入ylw.leanapp.cn

### 情况3：要支持根域名的MX记录

大部分的域名服务商，不会允许MX和CNAME同时做根域名的解析，为的是防止邮件服务不可用。所以此时想设置针对根域名的CNAME解析就会悲剧。

但是又不能依赖空间服务商提供的二级域名对应的IP地址，因为会经常变（比如空间服务商受到了DDOS攻击等情况）。所以只能买一个IP固定或者可控的接入主机，将根域名解析到这个IP，并且设置redirect到www子域。

### 情况4：显性URL 和 隐性URL？

是的，域名服务商支持这两种解析，可以解决根域向子域转发的问题。但是大部分都必须同时满足备案和接入必须都在同一服务商的条件，这样当你的空间服务商是另一家的时候，就无法使用这个功能了。

## 综述

综上所述，更多的情况还是会应用**情况3**中描述的接入方式。

